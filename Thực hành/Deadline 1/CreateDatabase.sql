USE master
GO

DROP DATABASE QUAN_LY_CHUYEN_BAY
GO

CREATE DATABASE QUAN_LY_CHUYEN_BAY
GO

USE QUAN_LY_CHUYEN_BAY
GO

-- KHACHHANG(MAKH, TEN, DCHI, DTHOAI)
CREATE TABLE KHACHHANG (
    MAKH CHAR(15),
    TEN NVARCHAR(15),
    DCHI NVARCHAR(50),
    DTHOAI CHAR(12),

    CONSTRAINT PK_KHACHHANG PRIMARY KEY (MAKH)
)
GO

-- NHANVIEN(MANV,TEN, DCHI, DTHOAI, LUONG, LOAINV)
CREATE TABLE NHANVIEN (
    MANV CHAR(15),
    TEN NVARCHAR(15),
    DCHI NVARCHAR(50),
    DTHOAI CHAR(12),
    LUONG FLOAT,
    LOAINV BIT,

    CONSTRAINT PK_NHANVIEN PRIMARY KEY (MANV)
)
GO

-- LOAIMB(MALOAI, HANGSX)
CREATE TABLE LOAIMB (
    MALOAI CHAR(15),
    HANGSX NVARCHAR(15),

    CONSTRAINT PK_LOAIMB PRIMARY KEY (MALOAI)
)
GO

-- MAYBAY(SOHIEU, MALOAI)
CREATE TABLE MAYBAY (
    SOHIEU INT,
    MALOAI CHAR(15),

    CONSTRAINT PK_MAYBAY PRIMARY KEY (SOHIEU, MALOAI)
)
GO

-- CHUYENBAY(MACB, SBDI, SBDEN, GIODI, GIODEN)
CREATE TABLE CHUYENBAY (
    MACB CHAR(4),
    SBDI CHAR(3),
    SBDEN CHAR(3),
    GIODI TIME,
    GIODEN TIME,

    CONSTRAINT PK_CHUYENBAY PRIMARY KEY (MACB)
)
GO

-- LICHBAY(NGAYDI, MACB, SOHIEU, MALOAI)
CREATE TABLE LICHBAY (
    NGAYDI DATE,
    MACB CHAR(4),
    SOHIEU INT,
    MALOAI CHAR(15),

    CONSTRAINT PK_LICHBAY PRIMARY KEY (NGAYDI, MACB)
)
GO

-- DATCHO(MAKH, NGAYDI, MACB)
CREATE TABLE DATCHO (
    MAKH CHAR(15),
    NGAYDI DATE,
    MACB CHAR(4),

    CONSTRAINT PK_DATCHO PRIMARY KEY (MAKH, NGAYDI, MACB)
)
GO

-- KHANANG(MANV, MALOAI)
CREATE TABLE KHANANG (
    MANV CHAR(15),
    MALOAI CHAR(15),

    CONSTRAINT PK_KHANANG PRIMARY KEY (MANV, MALOAI)
)
GO

-- PHANCONG(MANV, NGAYDI, MACB)
CREATE TABLE PHANCONG (
    MANV CHAR(15),
    NGAYDI DATE, 
    MACB CHAR(4),

    CONSTRAINT PK_PHANCONG PRIMARY KEY (MANV, NGAYDI, MACB)
)
GO

-- INSERT FOREIGN KEYS
ALTER TABLE LICHBAY ADD CONSTRAINT FK_LICHBAY_CHUYENBAY FOREIGN KEY (MACB) REFERENCES CHUYENBAY(MACB)
GO

ALTER TABLE DATCHO ADD CONSTRAINT FK_DATCHO_LICHBAY FOREIGN KEY (NGAYDI, MACB) REFERENCES LICHBAY(NGAYDI, MACB)
GO

ALTER TABLE DATCHO ADD CONSTRAINT FK_DATCHO_KHACHHANG FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)
GO

ALTER TABLE PHANCONG ADD CONSTRAINT FK_PHANCONG_LICHBAY FOREIGN KEY (NGAYDI, MACB) REFERENCES LICHBAY(NGAYDI, MACB)
GO

ALTER TABLE PHANCONG ADD CONSTRAINT FK_PHANCONG_NHANVIEN FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
GO

ALTER TABLE KHANANG ADD CONSTRAINT FK_KHANANG_NHANVIEN FOREIGN KEY (MANV) REFERENCES NHANVIEN (MANV)
GO

ALTER TABLE KHANANG ADD CONSTRAINT FK_KHANANG_LOAIMB FOREIGN KEY (MALOAI) REFERENCES LOAIMB(MALOAI)
GO

ALTER TABLE MAYBAY ADD CONSTRAINT FK_MAYBAY_LOAIMB FOREIGN KEY (MALOAI) REFERENCES LOAIMB(MALOAI)
GO

ALTER TABLE LICHBAY ADD CONSTRAINT FK_LICHBAY_MAYBAY FOREIGN KEY (SOHIEU, MALOAI) REFERENCES MAYBAY(SOHIEU, MALOAI)
GO

-- INSERT DATA NHANVIEN
INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1006', 'Chi', '12/6 Nguyen Kiem', '8120012', 150000, 0)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1005', 'Giao', '65 Nguyen Thai Son', 8324467, 500000, 0)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1001','Huong','8 Dien Bien Phu','8330733',500000,1)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1002','Phong','1 Ly Thuong Kiet','8308117',450000,1)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1004','Phuong','351 Lac Long Quan','8308155',250000,0)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1003','Quang','78 Truong Dinh','8324461',350000,1)
GO

INSERT NHANVIEN (MANV, TEN, DCHI, DTHOAI, LUONG, LOAINV)
VALUES ('1007','Tam','36 Nguyen Van Cu','8458188',500000,0)
GO

-- INSERT KHACHHANG
INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0009','Nga','223 Nguyen Trai','8932320')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0101','Anh','567 Tran Phu','8826729')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0045','Thu','285 Le Loi','8932203')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0012','Ha','435 Quang Trung','8933232')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0238','Hung','456 Pasteur','9812101')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0397','Thanh','234 Le Van Si','8952943')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0582','Mai','789 Nguyen Du', NULL)
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0934','Minh','678 Le Lai', NULL)
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0091','Hai','345 Hung Vuong','8893223')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0314','Phuong','395 Vo Van Tan','8232320')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0613','Vu','348 CMT8','8343232')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0586','Son','123 Bach Dang','8556223')
GO

INSERT KHACHHANG (MAKH,TEN,DCHI,DTHOAI)
VALUES ('0422','Tien','75 Nguyen Thong','8332222')
GO

-- INSERT CHUYENBAY
INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('100','SLC','BOS','08:00','17:50')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('112','DCA','DEN','14:00','18:07')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('121','STL','SLC','07:00','09:13')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('122','STL','YYV','08:30','10:19')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('206','DFW','STL','09:00','11:40')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('330','JFK','YYV','16:00','18:53')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('334','ORD','MIA','12:00','14:14')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('335','MIA','ORD','15:00','17:14')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('336','ORD','MIA','18:00','20:14')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('337','MIA','ORD','20:30','23:53')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('394','DFW','MIA','19:00','21:30')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('395','MIA','DFW','21:00','23:43')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('449','CDG','DEN','10:00','19:29')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('930','YYV','DCA','13:00','16:10')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('931','DCA','YYV','17:00','18:10')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('932','DCA','YYV','18:00','19:10')
GO

INSERT CHUYENBAY (MACB,SBDI,SBDEN,GIODI,GIODEN)
VALUES ('991','BOS','ORD','17:00','18:22')
GO

-- INSERT LOAIMB
INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Airbus','A310')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Airbus','A320')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Airbus','A330')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Airbus','A340')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Boeing','B727')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Boeing','B747')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('Boeing','B757')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('MD','DC10')
GO

INSERT LOAIMB (HANGSX,MALOAI)
VALUES ('MD','DC9')
GO

-- INSERT KHANANG
INSERT KHANANG (MANV,MALOAI)
VALUES ('1001','B727')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1001','B747')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1001','DC10')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1001','DC9')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1002','A320')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1002','A340')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1002','B757')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1002','DC9')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1003','A310')
GO

INSERT KHANANG (MANV,MALOAI)
VALUES ('1003','DC9')
GO

-- INSERT MAYBAY
INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (10,'B747')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (11,'B727')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (13,'B727')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (13,'B747')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (21,'DC10')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (21,'DC9')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (22,'B757')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (22,'DC9')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (23,'DC9')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (24,'DC9')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (70,'A310')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (80,'A310')
GO

INSERT MAYBAY (SOHIEU,MALOAI)
VALUES (93,'B757')
GO

-- INSERT LICHBAY
INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000','100',80,'A310')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000','112',21,'DC10')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000','206',22,'DC9')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000','334',10,'B747')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000', '395',23,'DC9')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000', '991',22,'B757')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('11/1/2000','337',10,'B747')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','100',11,'B727')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000', '112',11,'B727')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','206',13,'B727')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','334',10,'B747')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','335',10,'B747')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','337',24,'DC9')
GO

INSERT LICHBAY (NGAYDI,MACB,SOHIEU,MALOAI)
VALUES ('10/31/2000','449',70,'A310')
GO

-- INSERT PHANCONG
INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1001','11/01/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1001','10/31/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1002','11/01/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1002','10/31/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1003','10/31/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1003','10/31/2000','337')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1004','10/31/2000','100')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1004','10/31/2000','337')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1005','10/31/2000','337')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1006','11/01/2000','991')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1006','10/31/2000','337')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1007','11/01/2000','112')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1007','11/01/2000','991')
GO

INSERT PHANCONG (MANV,NGAYDI,MACB)
VALUES ('1007','10/31/2000','206')
GO

-- INSERT DATCHO
INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0009','11/01/2000','100')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0009','10/31/2000','449')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0045','11/01/2000','991')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0012','10/31/2000','206')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0238','10/31/2000','334')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0582','11/01/2000','991')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0091','11/01/2000','100')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0314','10/31/2000','449')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0613','11/01/2000','100')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0586','11/01/2000','991')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0586','10/31/2000','100')
GO

INSERT DATCHO (MAKH,NGAYDI,MACB)
VALUES ('0422','10/31/2000','449')
GO